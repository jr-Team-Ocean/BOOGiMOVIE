<!DOCTYPE html>
<html lang="en" xmlns="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" th:href="@{/css/common/font.css}">
    <!-- <link rel="stylesheet" href="../../static/css/common/header.css"> -->
    <!-- <link rel="stylesheet" href="../../static/css/common/footer.css"> -->
    <!-- <link rel="stylesheet" th:href="@{/css/common/bot-nav-btn.css}"> -->
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js" integrity="sha384-G/EV+4j2dNv+tEPo3++6LCgdCROaejBqfUeNjuKAiuXbjrxilcCdDz6ZAVfHWe1Y" crossorigin="anonymous"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet">
    
    <script src="https://kit.fontawesome.com/f7459b8054.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <link rel="stylesheet" th:href="@{/css/book/bookDetail-style.css}">
    
    
    <title>도서 상세 페이지</title>
</head>
<body>
    
    <!-- 헤더 -->
    <th:block th:replace="~{common/header}"></th:block>



    <main class="main">

        <section class="book-category-path">
            <!-- 도서 경로 -->
            <span>도서</span> 
            <span>&gt;</span> 

            <!-- 부모카테고리 있을때만 -->
            <a th:if="${book.pCategoryId != null}"
                th:href="@{/books(category=${book.pCategoryId})}"
                th:text="${book.pCategoryName}">
            </a>
            
            <span th:if="${book.pCategoryId != null}"> &gt; </span>

            <!-- 카테고리 -->
            <a th:href="@{/books(category=${book.categoryId})}"
                th:text="${book.categoryName}">
            </a>

            <!-- 관리자용 수정 삭제 -->
            <div class="book-edit" sec:authorize="hasRole('ADMIN')">
                <span class="go-update" id="update-btn">수정</span>
                <span>|</span>
                <span class="go-delete"  id="delete-btn">삭제</span>
            </div>
        </section>

        <section class="book-detail-main">
            <!-- 도서 이미지 -->
            <div class="img-area">
                <img class="book-cover" th:src="${book.imgPath}">
            </div>

            <div class="detail-area">
                <!-- 책 제목 -->
                <h1 class="book-title" th:text="${book.productTitle}">제목</h1>

                <!-- 책 기본 정보 -->
                <div class="book-info">
                    <span th:text="${#strings.listJoin(book.writers, ', ')}">작가</span>
                    <span>|</span>
                    <span th:each="p : ${book.publishers}" th:text="${p}">출판사</span>
                    <span>|</span>
                    <span th:text="${#temporals.format(book.productDate, 'yyyy.MM.dd')}">출간일</span>
                </div>

                <div class="book-rating">
                    <span>평점 <b class="rate-value" th:text="${reviewAvg}">4.4</b></span>


                    <button id="bookLikeBtn" >
                        <!-- <i class="fa-heart fa-solid"></i> -->
                        <!-- <i class="fa-heart fa-regular"></i> -->
                        <i class="fa-heart" 
                           th:classappend="${likeCheck} ? 'fa-solid' : 'fa-regular'" 
                           id="bookLike"></i>
                        <span id="likeCount" th:text="${likeCount}">0</span>
                    </button>
                </div>

                <div class="book-price">
                    <label>
                        수량
                        <input type="number" value="1" min="1">
                        개
                    </label>

                    <label class="sell-price">판매가 <b th:text="${book.productPrice}">가격</b>원</label>
                </div>
                
                <div class="book-buy">
                    <button class="add-cart">장바구니</button>
                    <button class="buy">구매하기</button>
                </div>

            </div>
        </section>

        <section class="book-detail-sub">

            <!-- 네비게이션 버튼 부분 -->
            <ul class="detail-nav nav nav-tabs" id="myTab" role="tablist">

                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="info-tab" data-bs-toggle="tab" data-bs-target="#info-tab-pane" type="button" role="tab" aria-controls="info-tab-pane" aria-selected="true">
                        상세정보</button>
                </li>
        
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="review-tab" data-bs-toggle="tab" data-bs-target="#review-tab-pane" type="button" role="tab" aria-controls="review-tab-pane" aria-selected="false">
                        후기</button>
                </li>
            </ul>
        
            <!-- 탭 컨텐츠 -->
            <!-- 네비게이션과 연동된 본문 부분 -->
            <div class="tab-content" id="myTabContent">
    
                <!-- 상세정보 탭 -->
                <div class="tab-pane fade show active" id="info-tab-pane" 
                    role="tabpanel" aria-labelledby="info-tab" tabindex="0">
                    
                    <!-- 정보 + 연관상품 페이지 -->
                    <th:block th:replace="~{book/bookDetailSub}"></th:block>
                </div>
                

                <!-- 후기 탭 -->
                <div class="tab-pane fade" id="review-tab-pane"
                    role="tabpanel" aria-labelledby="review-tab" tabindex="0">
                    
                    <!-- 후기 페이지 -->
                    <th:block th:replace="~{book/bookDetailComment}"></th:block>

                </div>

            </div>

        </section>

    </main>


    <!-- 푸터 -->
    <th:block th:replace="~{common/footer}"></th:block>

    <script th:inline="javascript">

        let loginMemberNo = /*[[${session.loginMember?.memberNo}]]*/ null;
        
        // ==> 만약 로그인한 회원의 번호가 없다면 빈칸을 집어넣겠다
        if (loginMemberNo == null) loginMemberNo = "";
        
        const memberNickname = /*[[${session.loginMember?.memberNickName}]]*/ "로그인한 회원 닉네임";

        const productNo = /*[[${book.productNo}]]*/ '게시글 번호';

    </script>


    <script th:src="@{/js/book/bookDetail.js}"></script>


</body>
</html> 




